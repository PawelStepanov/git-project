# Oписание проекта - Исследование данных магазина для увеличения покупательской активности


## Данные

Данные для работы находятся в нескольких таблицах.
Первая таблица, которая содержит данные о поведении покупателя на сайте, о коммуникациях с покупателем и его продуктовом поведении:
- Номер покупателя в корпоративной базе данных;
- Рассчитанный класс покупательской активности;
- Уровень сервиса;
- Информация о том, можно ли присылать покупателю дополнительные предложения о товаре;
- Среднемесячное значение маркетинговых коммуникаций компании, которое приходилось на покупателя за последние 6 месяцев.;
- Количество маркетинговых коммуникаций в текущем месяце;
- Сколько дней прошло с момента регистрации покупателя на сайте;
- Среднемесячная доля покупок по акции от общего числа покупок за последние 6 месяцев; 
- Самая популярная категория товаров у покупателя за последние 6 месяцев;
- Сколько в среднем категорий покупатель просмотрел за визит в течение последнего месяца;
- Общее число неоплаченных товаров в корзине за последние 3 месяца;
- Число сбоев, которые коснулись покупателя во время посещения сайта;
- Среднее количество страниц, которые просмотрел покупатель за один визит на сайт за последние 3 месяца.

Вторая таблица с данными о выручке, которую получает магазин с покупателя, то есть сколько покупатель всего потратил за период взаимодействия с сайтом:
- Номер покупателя в корпоративной базе данных;
- Название периода, во время которого зафиксирована выручка;
- Сумма выручки за период.

Третья таблица с данными о времени (в минутах), которое покупатель провёл на сайте в течение периода.
- Номер покупателя в корпоративной базе данных;
- Название периода, во время которого зафиксировано общее время;
- Значение времени, проведённого на сайте, в минутах.

Четвертая таблица содержит данные о среднемесячной прибыли покупателя за последние 3 месяца: какую прибыль получает магазин от продаж каждому покупателю:
- Номер покупателя в корпоративной базе данных;
- Значение прибыли.

## Задача

Разработать решение, которое позволит персонализировать предложения постоянным клиентам, чтобы увеличить их покупательскую активность. 

## Используемые модели и их результат применения

Для выполнения задачи, вопспользовались 4 моделями 
- LogisticRegression;
- SVC;
- KNeighborsClassifier;
- DecisionTreeClassifier.

Для этих моделей подбирали гиперпараметры при помощи *RandomizedSearchCV*. Также кодировали признаки несколькими способами *StandardScaler*, *MinMaxScaler* - для количественых признаков. *OneHotEncoder*, *OrdinalEncoder* - для категориальных признаков.

У *LogisticRegression* подбирали гиперпараметр *С*, который регулирует силу регуряризации. В качестве регурялизации взяли L1-регуряризацию.
У *SVC* c ядром *rbf* подбирали гиперпараметр *gamma*.
У *KNeighborsClassifier* подбирали гиперпараметр *n_neighbors*.
У *DecisionTreeClassifier* подбирали гиперпараметры *max_depth* и *max_features*.

Оценивали модель по метрике *ROC-AUC*, так как эта метрика классификации учитывает работу модели при всех возможных значениях порогов в отличие от других.

В результате получили, что лучшая модель это *LogisticRegression* с параметром C = 4. Метрика на тестовой выборке: 0.916.

## Используемые библиотеки
*pandas*
*matplotlib*
*seaborn*
*sklearn*
*shap*
*phik*
